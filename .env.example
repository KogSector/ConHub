# ===== ConHub - Environment Configuration Template =====
# Copy this file to .env and fill in your actual values

# === Environment Mode ===
# Controls which database URLs to use
# - 'local': Services run locally, connect to databases on localhost
# - 'docker': All services and databases run in Docker containers
# npm start automatically sets this to 'local'
# docker-compose automatically sets this to 'docker'
ENV_MODE=local

# === Application URLs ===
# Frontend uses Nginx as API gateway
NEXT_PUBLIC_API_URL=http://localhost
FRONTEND_URL=http://localhost:3000

# === Microservices URLs (Internal Communication) ===
# Backend Microservices
AUTH_SERVICE_URL=http://localhost:3010
BILLING_SERVICE_URL=http://localhost:3011
AI_SERVICE_URL=http://localhost:3012
DATA_SERVICE_URL=http://localhost:3013
SECURITY_SERVICE_URL=http://localhost:3014
WEBHOOK_SERVICE_URL=http://localhost:3015

# Other Services
# UNIFIED_INDEXER_URL=http://localhost:8080  # Disabled - not running in Docker
MCP_SERVICE_URL=http://localhost:3004

# === Environment ===
NODE_ENV=development
ENVIRONMENT=development
LOG_LEVEL=INFO
RUST_LOG=info

# === Service Ports ===
FRONTEND_PORT=3000

# Microservice Ports
AUTH_SERVICE_PORT=3010
BILLING_SERVICE_PORT=3011
AI_SERVICE_PORT=3012
DATA_SERVICE_PORT=3013
SECURITY_SERVICE_PORT=3014
WEBHOOK_SERVICE_PORT=3015

# Other Service Ports
MCP_SERVICE_PORT=3004
MCP_GOOGLE_DRIVE_PORT=3005
MCP_DROPBOX_PORT=3006
MCP_FILESYSTEM_PORT=3007
# UNIFIED_INDEXER_PORT=8080  # Disabled - not running in Docker

HOST=0.0.0.0

# === NextAuth Configuration ===
# Generate a secret using: openssl rand -base64 32
NEXTAUTH_SECRET=your-nextauth-secret-here
NEXTAUTH_URL=http://localhost:3000

# === OAuth Provider Configuration ===
# GitHub OAuth
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret

# Google OAuth
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret

# Bitbucket OAuth
BITBUCKET_CLIENT_ID=your-bitbucket-client-id
BITBUCKET_CLIENT_SECRET=your-bitbucket-client-secret

# === Auth0 Configuration (Optional - Alternative to NextAuth) ===
# Generate a secret using: openssl rand -hex 32
AUTH0_SECRET=your-auth0-secret-here
AUTH0_BASE_URL=http://localhost:3000
AUTH0_ISSUER_BASE_URL=https://your-auth0-domain.auth0.com
AUTH0_CLIENT_ID=your-frontend-auth0-client-id
AUTH0_CLIENT_SECRET=your-frontend-auth0-client-secret

# Public Auth0 (client-side)
NEXT_PUBLIC_AUTH0_DOMAIN=your-auth0-domain.auth0.com
NEXT_PUBLIC_AUTH0_CLIENT_ID=your-frontend-auth0-client-id

# Backend Auth0 (Machine-to-Machine)
AUTH0_M2M_CLIENT_ID=your-backend-auth0-client-id
AUTH0_M2M_CLIENT_SECRET=your-backend-auth0-client-secret
AUTH0_M2M_AUDIENCE=https://your-api-identifier

# === AI & LangChain Configuration ===
OPENAI_API_KEY=your_openai_api_key_here
ANTHROPIC_API_KEY=your_anthropic_api_key_here
JWT_SECRET=your_jwt_secret_here

# === JWT RS256 Authentication Configuration ===
# Generate RSA key pair using:
# openssl genrsa -out private_key.pem 2048
# openssl rsa -in private_key.pem -pubout -out public_key.pem

# Private key (used by auth service to sign JWTs)
JWT_PRIVATE_KEY="-----BEGIN RSA PRIVATE KEY-----
YOUR_PRIVATE_KEY_HERE
-----END RSA PRIVATE KEY-----"

# Public key (used by other services to verify JWTs)
JWT_PUBLIC_KEY="-----BEGIN PUBLIC KEY-----
YOUR_PUBLIC_KEY_HERE
-----END PUBLIC KEY-----"

# JWT Settings
JWT_ISSUER=conhub
JWT_AUDIENCE=conhub-api
JWT_ACCESS_TOKEN_EXPIRY=3600  # 1 hour in seconds
JWT_REFRESH_TOKEN_EXPIRY=604800  # 7 days in seconds

# Security Settings
BCRYPT_ROUNDS=12
MAX_LOGIN_ATTEMPTS=5
ACCOUNT_LOCKOUT_DURATION=900  # 15 minutes in seconds

# Rate Limiting
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_BURST=10

# === Qdrant Vector Database Configuration ===
# Qdrant URLs (service reads ENV_MODE to choose)
QDRANT_URL_LOCAL=http://localhost:6333
QDRANT_URL_DOCKER=http://qdrant:6333
# For production (using Qdrant Cloud)
# QDRANT_URL=https://your-cluster-url.qdrant.tech
# QDRANT_API_KEY=your_qdrant_api_key_here
QDRANT_COLLECTION_CODE=conhub_code
QDRANT_COLLECTION_DOCS=conhub_documents
QDRANT_COLLECTION_URLS=conhub_urls
QDRANT_COLLECTION_CONVERSATIONS=conhub_conversations

# === Data Source API Keys ===
GITHUB_ACCESS_TOKEN=your_github_token_here
GOOGLE_DRIVE_CLIENT_ID=your_google_drive_client_id_here
GOOGLE_DRIVE_CLIENT_SECRET=your_google_drive_client_secret_here
NOTION_API_KEY=your_notion_api_key_here

# === Haystack Configuration ===
# Document Store
USE_IN_MEMORY_STORE=true

# Elasticsearch (production alternative)
# USE_IN_MEMORY_STORE=false
# ELASTICSEARCH_HOST=localhost
# ELASTICSEARCH_PORT=9200
# ELASTICSEARCH_USERNAME=
# ELASTICSEARCH_PASSWORD=
# ELASTICSEARCH_INDEX=conhub-documents

# Embedding Models (used by embedding service - currently disabled)
# EMBEDDING_MODEL=sentence-transformers/all-MiniLM-L6-v2
# USE_OPENAI_EMBEDDINGS=false
# READER_MODEL=deepset/roberta-base-squad2

# File Processing
MAX_FILE_SIZE_MB=50
SUPPORTED_EXTENSIONS=.txt,.pdf,.docx,.md,.html

# === Database Configuration ===
# DATABASE_URL=postgresql://user:password@localhost:5432/conhub

# === Email Configuration ===
# SMTP settings for sending emails
# For Gmail, you'll need to create an "App Password" for this to work.
# See: https://support.google.com/accounts/answer/185833
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-gmail-app-password
FROM_EMAIL=your-email@gmail.com
FROM_NAME=ConHub

# === Security ===
API_KEY_HEADER=X-API-Key
# API_KEY=your-api-key-here

# === CORS Configuration ===
CORS_ORIGIN=http://localhost:3000
CORS_ORIGINS=["http://localhost:3000", "http://localhost:3001", "http://localhost:3002"]

# === MCP Service Configuration ===
MCP_SERVICE_PORT=3004
BACKEND_URL=http://localhost:3001

# === AI Agent Configuration ===
# GitHub Copilot Configuration
GITHUB_COPILOT_API_URL=https://api.github.com/copilot
GITHUB_COPILOT_WEBHOOK_SECRET=your_github_copilot_webhook_secret
GITHUB_CLIENT_ID=your_github_client_id
GITHUB_CLIENT_SECRET=your_github_client_secret

# Amazon Q Configuration
AMAZON_Q_API_URL=https://q.aws.amazon.com/api
AMAZON_Q_WEBHOOK_SECRET=your_amazon_q_webhook_secret
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key

# Cline Configuration
CLINE_API_URL=http://localhost:3005
CLINE_WEBHOOK_SECRET=your_cline_webhook_secret

# Generic Webhook Configuration
GENERIC_WEBHOOK_SECRET=your_generic_webhook_secret

# === Database Configuration ===
# Services automatically use correct URLs based on ENV_MODE:
# - ENV_MODE=local: Uses localhost URLs (for npm start)
# - ENV_MODE=docker: Uses service names (for docker-compose)

# PostgreSQL URLs (service reads ENV_MODE to choose)
DATABASE_URL_LOCAL=postgresql://neondb_owner:npg_w8jLMEkgsxc9@ep-wispy-credit-aazkw4fu-pooler.westus3.azure.neon.tech/neondb?sslmode=require
DATABASE_URL_DOCKER=postgresql://conhub:conhub_password@postgres:5432/conhub
# Neon Cloud Postgres (optional, preferred when present during `npm start`)
# Example: postgresql://user:password@<neon-host>/<db>?sslmode=require
# Set this to your Neon connection string to use Neon in local mode.
DATABASE_URL_NEON=
POSTGRES_DB=conhub
POSTGRES_USER=conhub
POSTGRES_PASSWORD=conhub_password
POSTGRES_HOST=localhost
POSTGRES_PORT=5432

# Redis URLs (service reads ENV_MODE to choose)
REDIS_URL_LOCAL=redis://localhost:6379
REDIS_URL_DOCKER=redis://redis:6379

# === Monitoring and Logging ===
ENABLE_METRICS=true
METRICS_PORT=9090

# === Security Configuration ===
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
ENABLE_HELMET=true

# === WebSocket Configuration ===
WS_HEARTBEAT_INTERVAL=30000
WS_MAX_CONNECTIONS=1000

# === MCP Protocol Configuration ===
MCP_PROTOCOL_VERSION=2024-11-05
MCP_CONNECTION_TIMEOUT=30000
MCP_MAX_RETRIES=3

# === MCP External Servers Configuration ===
# Google Drive MCP Server
MCP_GOOGLE_DRIVE_ENDPOINT=http://localhost:3005
MCP_GOOGLE_DRIVE_PORT=3005
GOOGLE_DRIVE_REDIRECT_URI=http://localhost:3005/oauth/callback

# Dropbox MCP Server
MCP_DROPBOX_ENDPOINT=http://localhost:3006
MCP_DROPBOX_PORT=3006
DROPBOX_ACCESS_TOKEN=your_dropbox_access_token_here

# Filesystem MCP Server
MCP_FILESYSTEM_ENDPOINT=http://localhost:3007
MCP_FILESYSTEM_PORT=3007
FILE_SYSTEM_ALLOWED_PATHS=/workspace/data,/workspace/uploads

# === Data Source Connectors Configuration ===
# GitLab (for self-hosted instances)
GITLAB_INSTANCE_URL=https://gitlab.com
GITLAB_ACCESS_TOKEN=your_gitlab_token_here

# Dropbox Connector (additional for backend connector, separate from MCP)
DROPBOX_APP_KEY=your_dropbox_app_key_here
DROPBOX_APP_SECRET=your_dropbox_app_secret_here

# OneDrive / Microsoft Graph
MICROSOFT_CLIENT_ID=your_azure_app_id_here
MICROSOFT_CLIENT_SECRET=your_azure_app_secret_here
MICROSOFT_TENANT_ID=common
ONEDRIVE_ACCESS_TOKEN=your_onedrive_token_here

# Webhook Base URL (for registering webhooks with data sources)
WEBHOOK_BASE_URL=https://your-domain.com

# === Development Configuration ===
ENABLE_SWAGGER=true
ENABLE_DEBUG_LOGS=true
MOCK_AI_RESPONSES=true

# === Service URLs ===
EMAIL_SERVICE_URL=http://localhost:3003

# === Stripe Payment Configuration ===
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key_here
STRIPE_WEBHOOK_SECRET=whsec_your_stripe_webhook_secret_here
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key_here
